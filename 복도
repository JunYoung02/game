
#include<Windows.h>
#include<stdio.h>
#include<conio.h>
#include<time.h>

#define Space 32    // 스페이스바의 아스키코드 
#define DARKBLUE 1      // 글자 다크 블루 1
#define DARKGREEN 2         // 글자 다크 그린
#define GRAY 7      // 글자 그레이 7
#define DARKGRAY 8 // 글자 다크 그레이 8
#define SKYBLUE 11   // 글자 스카이 블루 11
#define RED 12      // 글자 빨간색 12
#define PURPLE 13   // 글자 보라색 13
#define YELLOW 14   // 글자 노란색 14
#define WHITE 15   // 글자 흰색 15

#define TRUE 1      // 참 1
#define FALSE 0     // 거짓 0


void gotoxy(int x, int y);   // 좌표 설정 함수
void chcolor(int co);      // 글자 색 입히기, co에 원하는 색 입력
void GameSet();         // 게임 테두리 

// 이번에 추가한 함수들
#define UP 72
#define DOWN 80
#define LEFT 75
#define RIGHT 77


void drawway();     // 복도 그리기 힘수
void moveway();     // 복도에서 움직이는 함수

int way[15][79] =   // 복도, 1은 벽. 9는 복도의 끝지점, 2는 캐릭터
{
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,8,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,8,0,0,8,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,8,0,0,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9},
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
    
};

void drawway()      // 복도를 그리는 함수
{
    int i, j, y = 18 , k = 0;

    for (i = 0; i < 15; i++)
    {
        gotoxy(5, y++);

        for (j = 0; j < 79; j++)
        {
            chcolor(SKYBLUE);
            k = way[i][j];

            switch (k)
            {
            case 0:
                printf("  ");
                break;
            case 1:
                printf("▤");
                break;
            case 2:
                chcolor(WHITE);
                printf("옷");
                break;
            case 8:
                chcolor(RED);
                printf("■");
                break;
            case 9:
                chcolor(YELLOW);
                printf("▦");
                break;
            }
        }
    }
}

void moveway()      // 복도에서 캐릭터가 움직이도록 만들어줌
{
    int site;
    int x = 5, y = 0;       // 처음 캐릭터의 위치

    while (1)           // 미로 게임과 원리가 같다
    {
        drawway();
        site = _getch();

        switch (site)
        {
        case 224:

            site = _getch();

            switch (site)       // 이동 가능한 곳이면 플레이어를 움직이고, 이전에 있던 곳은 0으로 바꿔준다.
            {
            case RIGHT:
                y++;
                if (way[x][y] == 0)
                {
                    way[x][y] = 2;
                    way[x][y - 1] = 0;
                }
                else if (way[x][y] == 1 || way[x][y] == 8)
                {
                    y--;
                }
                break;
            case LEFT:      // 왼쪽과 위에키만 문제 발견
                y--;
                if (y == -1)
                {
                    y++;
                    continue;
                }
                else if (way[x][y] == 0)
                {
                    way[x][y] = 2;
                    way[x][y + 1] = 0;
                }
                else if (way[x][y] == 1 || way[x][y] == 8)
                {
                    y++;
                }
                break;
            case UP:
                x--;
                if (x == -1)    // 2차원 배열에서 -1값이 나올 순 없으므로, -1이 나오면 건너뛰고 진행하도록 설정
                {
                    x++;
                    continue;
                }
                else if (way[x][y] == 0)
                {
                    way[x][y] = 2;
                    way[x + 1][y] = 0;
                }
                else if (way[x][y] == 1 || way[x][y] == 8)
                {
                    x++;
                }
                break;
            case DOWN:
                x++;
                if (way[x][y] == 0)
                {
                    way[x][y] = 2;
                    way[x - 1][y] = 0;
                }
                else if (way[x][y] == 1 || way[x][y] == 8)
                {
                    x--;
                }
                break;
            }
        }
        if (way[x][y] == 9)        // 플레이어가 종점에 도착했을 경우
        {
            way[x][y] = 2;
            system("cls");
            GameSet();

            chcolor(WHITE); gotoxy(20, 10); printf("게임 끝");
            break;
        }
    }
}


void WalkWay()      // 복도벽에 써있는 글씨
{
    int i;


    chcolor(RED);      //복도 위쪽 벽
    gotoxy(35, 5);  printf("■            ■     ■■■■■■■■     ■                   ■                        ■");
    gotoxy(35, 6);  printf("■            ■     ■                   ■                   ■                      ■  ■");
    gotoxy(35, 7);  printf("■            ■     ■                   ■                   ■                    ■      ■ ");
    gotoxy(35, 8);  printf("■            ■     ■                   ■                   ■                  ■          ■");
    gotoxy(35, 9);  printf("■            ■     ■                   ■                   ■                ■              ■     ");
    gotoxy(35, 10); printf("■■■■■■■■     ■■■■■■■■     ■                   ■              ■                  ■");
    gotoxy(35, 11); printf("■            ■     ■                   ■                   ■                ■              ■");
    gotoxy(35, 12); printf("■            ■     ■                   ■                   ■                  ■          ■");
    gotoxy(35, 13); printf("■            ■     ■                   ■                   ■                    ■      ■");
    gotoxy(35, 14); printf("■            ■     ■                   ■                   ■                      ■  ■");
    gotoxy(35, 15); printf("■            ■     ■■■■■■■■     ■■■■■■■■     ■■■■■■■            ■");

    chcolor(RED);      //복도 아래 벽에 써있는 글씨
    gotoxy(35, 36); printf("■■■                   ■■■       ■■■            ■■■■        ■              ■■■■");
    gotoxy(35, 37); printf("  ■                       ■       ■      ■          ■     ■       ■              ■      ■");
    gotoxy(35, 38); printf("   ■                     ■      ■          ■        ■      ■      ■              ■       ■  ");
    gotoxy(35, 39); printf("    ■                   ■     ■              ■      ■     ■       ■              ■        ■");
    gotoxy(35, 40); printf("     ■                 ■    ■                  ■    ■■■■        ■              ■         ■");
    gotoxy(35, 41); printf("      ■      ■       ■     ■                  ■    ■     ■       ■              ■         ■");
    gotoxy(35, 42); printf("       ■    ■■     ■        ■              ■      ■      ■      ■              ■        ■");
    gotoxy(35, 43); printf("        ■  ■  ■  ■            ■          ■        ■       ■     ■              ■       ■");
    gotoxy(35, 44); printf("         ■■    ■■               ■      ■          ■        ■    ■              ■      ■ ");
    gotoxy(35, 45); printf("          ■      ■                  ■■■            ■         ■   ■■■■■■    ■■■■");
}

int main()
{
    int kb;
    system("mode con cols=170 lines=50");    //cols = 칸/행 (가로)  lines = 줄/열 (세로)


    GameSet();          // 게임 테두리 출력

    // 이번 코드 동작

    WalkWay();
    moveway();

    // 계속하려면,, 이 보여서 없애주기 위해 만듦, 지우면 됨
    kb = _getch();
    if (kb == Space)
    {
        system("cls");
    }
}


void gotoxy(int x, int y)   // 좌표 설정 함수
{
    COORD pos = { x,y };
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), pos);
}

void chcolor(int co)      // 글자 색 입히기, co에 원하는 색 입력
{

    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), co);
}

void GameSet()      // 게임 테두리
{
    int i;

    chcolor(PURPLE);
    gotoxy(3, 2);  printf("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■");

    for (i = 3; i < 48; i++)
    {
        gotoxy(3, i); printf("■");
        gotoxy(163, i); printf("■");
    }

    gotoxy(3, 48);  printf("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■");
}